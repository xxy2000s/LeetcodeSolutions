<h1 align = "center">北京邮电大学</h1>
<h2 align = "center">信息网络建模与仿真实验报告</h2>
<center>
    <img src = "https://pictures.xiaxuyang.com/img/image-20201028170257787.png"</>
</center>

&#160;
&#160;
&#160;
&#160;

<h5 style="text-align:center">

&emsp;&emsp;&emsp;&emsp;&emsp;实验名称：随机变量与随机过程的产生

&emsp;&emsp;&emsp;  学院：&emsp;&emsp;&emsp;&emsp;&emsp;信息与通信工程

&emsp;&emsp;&emsp;班级：&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;2018211123

&emsp;&emsp;&emsp;学号：&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;2018210220

&emsp;&emsp;姓名: &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;夏绪洋
 </h5>

&#160;
&#160;
&#160;
&#160;


### 实验一：均匀分布随机数的产生

- #### 1、实验原理
 **(1) 线性同余法:**
  - 采用下述公式产生随机数：
  $$x_{n+1}=\left[a x_{n}+b\right] \bmod (m)$$

- 其中$x_n$是第n个随机数，a为乘子，b为增量，m为模数，$0≤x_0<m$ 为随机数源或种子（seed），均为非负整数。
- 令 $U_n≔x_n∕m$，则可得到[0,1)区间上的随机数。
- 若a!=0, b!=0，称为混合同余法 
- 若a=1，b!=0，称为加同余法
- 若a!=0, b=0，称为乘同余法
- 研究表明，乘同余法优于加同余法，而混合同余法与简单的乘同余法相比并无显著优点。
- 所以本次实验采用乘同余法 各参数a=16807，b=0，m=2147483647。

**(2)梅森旋转法：**
- 梅森旋转算法是迄今为止最好的随机数发生器之一，可以产生高质量的伪随机数，并且效率高效，弥补了传统伪随机数生成器的不足。
- 梅森旋转算法的最长周期取自一个梅森素数，由此命名为梅森旋转算法。常见的两种为基于32位的MT19937-32和基于64位的MT19937-64。
- 梅森旋转法递推式： 
$$
x_{k+n}:=x_{k+m} \oplus\left(x_{k}^{u} \mid x_{k+1}^{l}\right) A, \quad k=0,1, \ldots
$$
  -  $\mathbf{\square} x_{i}$ 是w位的字向量
  - $\mathbf{\square}\left(x_{k}^{u} \mid x_{k+1}^{l}\right):$ 将 $x_{k}$ 的前 $w$ - $r$ 位与 $x_{k+1}$ 的后 $r$ 位连接，组成一个新的w位的字向量
-  $$Twist: \quad A=R=\left(\begin{array}{cc}
0 & \mathbf{I}_{w-1} \\
a_{w-1} & \left(a_{w-2}, \ldots a_{0}\right)
\end{array}\right)
$$
- A的特殊结构使得tA的计算得以简化：位移运算
$t A=\left\{\begin{array}{cl}t \gg 1 & t_{0}=0 \\ (t \gg 1) \oplus a & t_{0}=1\end{array}\right.$
  - $t=t_{w-1}, t_{w-2}, \ldots t_{0} \text { 是 } w \text { 位的字向量 } $
  - $a=a_{w-1},a_{w-2},a_0$

  &#160;

- #### 2、实验结果展示

<center>
    <img src = "https://pictures.xiaxuyang.com/img/image-20201026165817552.png"</>
</center>

<center>图1：左右分布为线性同余法和梅森旋转法产生的100000个随机数分布</center>
<center>
    <img src = "https://pictures.xiaxuyang.com/img/image-20201026165846803.png"</>
</center>
<center>图2：产生的PDF,CDF图像</center>

&#160;

- #### 3、实验结果分析

- **线性同余法:** 如图1左，在[0,1]等分的10个区间内，每个区间中随机数量大致相同，并且随机数总数越多越符合均匀分布的规律。下表为随机数的统计量，均保留三位小数：


|      | 实验值 | 理论值 |
| :--- | :----: | ----: |
| 均值 | 0.4996 | 0.500 |
| 方差    | 0.0827      | 0.083     |
| 标准差 | 0.2888 | 0.289 |

  - 概率密度（PDF）是一条在1上下微小波动的曲线，与理论值大致吻合。
  - 分布函数（CDF）是一条斜率为1的过原点的直线，与理论值大致吻合。
  
                                       
  &#160;
  
  - **MT法:** 图1右所示，在[0,1]等分的10个区间内，每个区间内随机数量大致相同，符合均匀分布规律。以下为其统计量：

|      | 实验值 | 理论值 |
| :--- | :----: | ----: |
| 均值 | 0.4998 | 0.500 |
| 方差    | 0.0828      | 0.083     |
| 标准差 | 0.2887 | 0.289 |

  &#160;



### 实验二：Pareto分布



- #### 1、实验原理
- 由概率论可知，累积分布函数具有以下特点：单调不减函数、右连续函数、值域为[0,1]，如果目标随机变量的累积分布函数具有闭式表达式，就可以得到其反函数，其反函数的定义域：[0,1]。
- 如果连续分布随机变量X的累积分布函数为Fx(x)，则变量 $U=F_x(x)$服从[0,1]区间上的均匀分布，由均匀分布的独立随机序列U经过如下反变换，即可获得具有累积分布函数$F_x(x)$的随机变量序列$X=F_{x}^{-1} (U)$
- 基本流程：
  用随机数发生器产生在[0,1]区间上均匀分布的、独立的随机变量 U。将U代入到反变换$X=F_{x}^{-1} (U)$中，得到随机变量X。
&#160;
- #### 2、实验结果展示

<center>
    <img src = "https://pictures.xiaxuyang.com/img/image-20201028201455231.png"</>
</center>
<center>图3：基于均匀的Pareto的分布函数及PDF
</center>

  &#160;

- #### 3、实验结果分析
- 由图3左分析可知仿真结果遵循二八定律，符合Pareto分布
- 由图3右分析可知均匀分布产生的Pareto分布的PDF与理论的PDF接近

&#160;
### 实验三：标准高斯分布随机数



- #### 1、实验原理
- 在信息网络仿真中会常常碰到高斯随机变量
- 累积分布函数：
$$F(x)=\int_{-\infty}^{x} \frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{y^{2}}{2 \sigma^{2}}\right) d y$$
- 非闭合形式，反变换法不适用
- 概率密度函数具有闭合形式，舍选法可用，但效率非常低
- 需要采用一些特殊的方法产生高斯分布随机变量
  - 中心极限定理法
  - Box-Muller法
  - Box-Muller法与舍选法结合

- 实现步骤：
  - 中心极限定理：
    - 中心极限定理指出，当 $N \rightarrow \infty$ 时, $N$ 个独立随机变量之和的分布趋近于高斯分布
    - 基本步骤： 产生若干个 (0,1) 区间上的均匀分布随机数U $_{i}$ 
    - $ U_{i}-\frac{1}{2}$ 服从 $\left(-\frac{1}{2}, \frac{1}{2}\right)$ 的均匀分布，方差为 $\frac{1}{12}$
    - 取 $B=\sqrt{\frac{12}{N}},$ 则 $\mathrm{X}=B \sum_{i=1}^{N}\left(\mathrm{U}_{i}-\frac{1}{2}\right)$ 近似服从标准高斯分布
    - ー般, 取: $N=12$
  - Box-Muller:
    - 产生两个独立的(0,1)区间上均匀分布随机变量u1和u2
    - 根据瑞利分布的累积分布函数，对u1进行反变换
    $$F_{R}(r)=1-\exp \left(-\frac{r^{2}}{2 \sigma^{2}}\right), r \geq 0$$
    - 产生两个独立的、均值为0方差为1的高斯分布随机变量
    $$X=\sqrt{-2 \ln u_{1}} \cos \left(2 \pi u_{2}\right)  $$  $$ Y=\sqrt{-2 \ln u_{1}} \sin \left(2 \pi u_{2}\right)$$
- #### 2、实验结果展示

<center>
    <img src = "https://pictures.xiaxuyang.com/img/image-20201026170137756.png" </>
</center> 

<center>图4：从左到右依次为中心极限定理、Box-Muller数据分布图及对比图</center>
&#160;

- #### 3、实验结果分析
  - N足够大的时候，中心极限定理法和Box-Muller法均可以得到服从高斯分布的随机变量数据。
  - 由对比图可知，两个方法产生的差别很小。且在N很小的时候，两者均无法产生准确的高斯随机变量。
&#160;

### 实验四：混合高斯随机变量
- #### 1、实验原理
- 当目标连续随机变量x的累积分布函数F（x）可以表示为多个其它累积分布函数加权和的形式：
$$F(\mathrm{x})=\Sigma p_{i} F_{i}(x), 其中 p_{i} \geq 0, \Sigma p_{i}=1$$而这些分布函数 比目标变量分布函数F(x)更容易采样时，适合采用组合法。
&#160;
- 基本流程： 
  - 产生随机整数I，使P{I=i}$=p_i$ (离散反变换法）
  - 产生具有分布函数$F_i (x)$的随机变量$x_i$（连续反变换法）
  - 令$x=x_i$
&#160; 
- #### 2、实验结果展示

<center>
    <img src = "https://pictures.xiaxuyang.com/img/image-20201026170230503.png"</>
</center>

<center>图5:组合法的混合高斯对比理论混合高斯PDF</center>

&#160;
- #### 3、实验结果分析
  - 可以看出红蓝曲线基本重合，也即组合法产生的混合高斯图形与理论的混合高斯图形基本一致。则方法的误差很小，精度很高。 
&#160;
### 实验五：泊松过程

- #### 1、实验原理
- 泊松过程的定义：一种累计随机事件发生次数的最基本的独立增量过程
- 泊松过程的两种解释：
  - 某一时间内的事件发生次数服从泊松分布
  - 相邻两次事件发生的时间间隔服从指数分布
- 利用第二种解释，可以产生泊松过程
  - 产生均匀分布随机数
  - 利用反变换法产生指数分布随机数p
  - 把指数分布随机数作为时间间隔，可以得到一个时间序列
&#160;
- #### 2、实验结果展示

<center>
    <img src = "https://pictures.xiaxuyang.com/img/image-20201026170350064.png"</>
</center>

<center>图6:泊松过程仿真图</center>
&#160;

- #### 3、实验结果分析
  - 如图6左图所示：事件到达时间和事件个数在实验次数足够大的情形下接近成正比，其斜率$k=0.5=1/λ$
  - 如图6右图所示：模拟结果和理论结果曲线大致吻合，实验结果理想。