北京邮电大学
信息网络建模与仿真
实验报告
 


实验名称：     随机变量与随机过程的产生                      
学院：            信息与通信工程学院                              
班级：               2018211123                          
学号：               2018210439                                    
姓名：                 赵祖港                            



目录
北京邮电大学	1
实验一：均匀分布随机数的产生	3
实验二：基于均匀分布产生的pareto随机数	6
实验三：高斯随机变量	8
实验四：基于均匀分布的混合高斯	12
实验五：泊松过程	13




























实验一：均匀分布随机数的产生
1、实验内容
（1）利用 x_(i+1) =[16807x_i]mod(2147483647) 递推关系，编写程序，用线性同余法生成(0,1)区间上的随机数，计算其期望、方差和概率密度与理论值的吻合程度。 
（2） 分析 Mersenne Twister 产生均匀分布随机数的代码，并用该代码产生一组(0,1)区间上的随机数，计算其期望、方差和概率密度与理论值的吻合程度。
2、实现原理
	线性同余法采用公式x_(i+1)=[ax_i+b]mod(m) 产生随机数：
其中x_i是第i个随机数，a为乘子，b为增量，m为模数，0≤x_0<m为随机数源或种子（seed），均为非负整数。
令 U_i≔x_i∕m，则可得到[0,1)区间上的随机数。
若a!=0, b!=0，称为混合同余法 
若a=1，b!=0，称为加同余法
若a!=0, b=0，称为乘同余法
研究表明，乘同余法优于加同余法，而混合同余法与简单的 乘同余法相比并无显著优。所以本次实验采用乘同余法 各参数a=16807，b=0，m=2147483647。
（2）梅森旋转算法可以产生高质量的伪随机数，并且效率高效，弥补了传统伪随机数生成器的不足。梅森旋转算法的最长周期取自一个梅森素数，由此命名为梅森旋转算法。常见的两种为基于32位的MT19937-32和基于64位的MT19937-64。
 
图1 MT19937-32伪随机数生成器各参数
3、实现过程
线性同余法：按照所给公式x_(i+1) =[16807x_i]mod(2147483647) 并初始化x_0为10作为随机种子，通过for循环，产生递推公式生成[0,1]均匀分布的随机函数，并通过mean、var函数求得均值和方差，对方差求开平方的到标准差。通过hist函数返回的落在各个区间的样本个数和区间中点绘制PDF，并对PDF累加生成CDF。
MT法：Matlab中rand语句即可产生通过梅森法生成的[0,1]分布的随机数。其他求均值、方差、标准差、PDF、CDF的方法同线性同余法。
4、实验结果展示
 
图2 线性同余法产生的100000个随机数分布
 
图3 Mersenne Twister法产生的100000个随机数分布
 
图4 两种方法的CDF 图像
 
图4 两种方法的PDF图像
5、实验结果分析
线性同余法：如图2所示，在[0,1]均分的十个区间内，各区间内随机数量大致相同，均为10^5个左右，并且随机数总数个数越多越符合均匀分布的规律。以下为随机数的统计量，均保留三位小数：
	实际值	理论值
均值	0.4998	0.500
方差	0.0828	0.083
标准差	0.2888	0.289
概率密度（PDF）为在1上下微小波动的曲线，与理论值大致吻合。
分布函数（CDF）为斜率为1的过原点的直线，与理论值大致吻合。
MT法：如图3所示，在[0,1]均分的十个区间内，各区间内随机数量大致相同，均为10^5个左右，符合均匀分布规律。以下为其统计量：
	实际值	理论值
均值	0.5002	0.500
方差	0.0832	0.083
标准差	0.2888	0.289

实验二：基于均匀分布产生的pareto随机数
1、实验内容
互联网中流量分析建模中经常会用到 Pareto 分布，其概率密度函数为：
p(x)=(ab^a)/x^(a+1) ，b≤x<∞
以Mersenne Twister随机数产生器为基础产生服从Pareto分布的随机变量， 用 hist 函数画出其数据分布图。
2、实现原理
运用反变换法进行实现。
基本思想：
由概率论可知，累积分布函数具有以下特点：单调不减函数、右连续函数、值域为[0,1]，如果目标随机变量的累积分布函数具有闭式表达式，就可以得到其反函数，其反函数的定义域：[0,1]。
那么，如果连续分布随机变量X的累积分布函数为Fx(x)，则变量 U=Fx(x)服从[0,1]区间上的均匀分布，由均匀分布的独立随机序列U经过如下反变换，即可获得具有累积分布函数Fx(x)的随机变量序列X=F_x^(-1) (U)
基本流程：
用随机数发生器产生在[0,1]区间上均匀分布的、独立的随机变量 U。将U代入到反变换X=F_x^(-1) (U)中，得到随机变量X。
3、实现过程
已知Pareto分布，其概率密度函数为：p(x)=(ab^a)/x^(a+1) ，b≤x<∞
	对其积分求分布函数Fx(x)=1-b^a/x^a 
	运用finverse()求其反函数
	运用Mersenne Twister随机数产生器产生在[0,1]区间上均匀分布的独立随机变量
	带入反函数中，得到随机变量X
	求出X的PDF与理论值相比较
4、实验结果展示
 
图6 基于均匀的Pareto的分布函数
 
图7 基于均匀分布产生的Pareto的PDF
5、实验结果分析
由图6可知仿真结果符合二八定律，随机变量集中分布在20%的区域，即20%的原因造成80%的问题，符合pareto分布。由图6可知基于均匀分布产生的Pareto分布的PDF与理论PDF相近。
实验三：高斯随机变量
1、实验内容
用中心极限定理方法和 Box-Muller 算法分别产生标准高斯分布随机数， 在 Matlab 中观察数据分布；并比较两者之间的差别。
2、实现原理
（1）问题的引出	
高斯分布的累积分布函数：
F（x）=∫_(-∞)^x▒〖1/(√2π σ)  exp⁡(-y^2/(2σ^2 ))dy〗
累计分布函数为非闭合表达式，不适用最基础的反变换法。
高斯分布的概率密度函数：
f(x)=1/(√2π σ)  exp⁡(-〖(x-μ)〗^2/(2σ^2 ))
概率密度函数具有闭合形式，舍选法可用，但效率非常低。
故需要采用一些特殊的方法产生高斯分布随机变量：
中心极限定理法、Box-Muller法、Box-Muller法与舍选法结合
	中心极限定理（独立同分布的中心极限定理）
定理内容：
设随机变量X1，X2，......Xn，......独立同分布，并且具有有限的数学期望和方差：E(Xi)= ，D(Xi)= (k=1,2....)，则对任意x，
分布函数：F_n (x)=P{(∑_(i=1)^n▒〖X_i-nμ〗)/(σ√n)≤x}
满足：lim┬(n→∞)⁡〖F_n (x)〗=lim┬(n→∞) {(∑_(i=1)^n▒〖X_i-nμ〗)/(σ√n)≤x}=1/√2π ∫_(-∞)^x▒〖e^(-t^2/2) dt〗=∅(x)
该定理说明，n很大时，随机变量(∑_(i=1)^n▒〖X_i-nμ〗)/(σ√n)近似服从标准正态分布N(0,1)。
（3）中心极限定理的步骤
1. 产生若干个（0,1）区间上的均匀分布随机数U_i
2. U_i-1/2服从（-0.5,0.5）的均匀分布,方差为1/12
3. N个U_i-1/2相加，近似服从钧至为0，方差为N/12的高斯分布
4. 取B=√(12/N)，则	X=B∑_(i=1)^N▒〖(U_i-1/2)〗近似服从标准高斯分布（一般取N=12）

（4）Box-Muller方法
根据瑞利分布和高斯分布之间的对应关系 ：
如果X和Y为均值为0、方差为σ^2的独立高斯随机变量，那么R=√(X^2+Y^2 )服从参数为σ的瑞利分布。
定义：把X和Y分别作为复平面的两个坐标，则相角θ服从[0,2π]上的均匀分布。
将该关系反过来，就是Box-Muller方法的原理，由George Box和Mervin Muller在1958年提出。
（5）Box-Muller方法的步骤 
1.）产生两个独立的(0,1)区间上均匀分布随机变量u1和u2； 
2.）根据瑞利分布的累积分布函数，对u1进行反变换  
F_R (r)=1-exp⁡(-r^2/(2σ^2 )),r≫0          
3.）产生两个独立的、均值为0方差为1的高斯分布随机变量。 
X=√(-2lnu_1 ) cos⁡(2πu_2)Y=√(-2lnu_1 ) sin⁡(2πu_2)
3、实现过程
中心极限定理：在函数gauss_rand中产生100个（0,1）区间上的独立同均匀分布随机数U_i，再对这100个U_i求和再减去50，再乘√(12/n)，就得到一个目标高斯随机变量。
Box-Muller方法 ：用rand函数产生两个独立的(0,1)区间上均匀分布随机变量u1和u2 ； 再求√(-2log⁡(x1)) cos⁡(2πx2),即可得到结果。
4、实验结果展示
 
图8 中心极限定理数据分布图

 
图9 Box_muller数据分布图
 
图10 两种算法高斯分布对比图
5、实验结果分析
（1）N很大时，两种方法均可以得到服从高斯分布的随机变量。
（2）从两种方法的比较图看，两种方法差别不大。当N没有足够大时，两种方法均无法准确得到高斯随机变量。


实验四：基于均匀分布的混合高斯
实验内容
用组合法产生概率密度函数为f(x)=∑_(i=1)^3▒p_i   1/b_i  φ((x-a_i)/b_i )的混合高斯随机变量，画出其数据分布图。其中： ，a_1=-1，a_2=0，a_3=1，b_1=1/4，b_2=1，b_3=1/2。 
实现原理
基本思想：
当目标连续随机变量x的累积分布函数F（x）可以表示为多个其它累积分布函数加权和的形式：
F(x)=Σp_i F_i (x)，其中p_i≥0，∑p_i=1
而这些分布函数 比目标变量分布函数F(x)更容易采样时，适合采用组合法。
基本流程： 
	产生随机整数I，使P{I=i}=p_i (离散反变换法）
	产生具有分布函数F_i (x)的随机变量x_i（连续反变换法）
	令x=x_i
实现过程
1.产生（0，1）区间上的均匀随机变量X1
（1）当X1< 时,使用normrnd生成均值为-1，方差为1/4的正态分布函数
（2）当X1< 时,使用normrnd生成标准正太分布函数
（3）当X1<1时,使用normrnd生成均值为1，方差为1/2的正太分布函数
2.再使用Ksdensity()函数计算概率密度估计，之后使用plot函数绘制概率密度曲线。
到了比较阶段，我们使用normpdf函数来计算理论混合高斯PDF,，即可对比组合法产生的混合高斯与理论混合高斯。
实验结果展示
 
图11 组合法产生的混合高斯对比理论混合高斯pdf
实验结果分析
如图11所示，蓝色与红色曲线基本重合，组合法产生的混合高斯图形与理论混合高斯基本一致。
实验五：泊松过程
实验内容
产生一个参数λ等于 2 的泊松过程，存储事件发生的时间，统计单位时间内事件发生的次数，判断其与泊松分布是否吻合。
实现原理
（1）泊松过程的定义：一种累计随机事件发生次数的最基本的独立增量过程。例如随着时间增长累计某电话交换台收到的呼唤次数，就构成一个泊松过程。
（2）指数分布和泊松分布的关系：
	指数分布：独立随机事件的时间间隔；
	泊松分布：单位时间内的随机事件数；
（3）产生泊松分布的方法：
	产生指数分布随机数并求和，直到大于1为止，输出个数k；
	产生均匀分布随机数并求积，直到小于exp(-λ)为止，输出个数k ;
实现过程
采用产生指数分布求和的方式：
	产生均匀分布随机数
	利用反变换法产生指数分布随机数，反函数表达式为 
	把指数分布随机数作为时间间隔，可以得到一个时间序列，即：
tp(n)=tp(n-1)-1/lambda*log(x);
	n为泊松分布的一个样本，时间序列tp为泊松过程的一个样本.
实验结果展示
 
图12 泊松过程仿真图
 
图13泊松过程仿真图
实验结果分析
	如图12所示，事件到达时间和事件个数在实验次数很大的情况下接近正比且斜率k=0.5=1/λ，即指数分布的均值；
	如图13所示，模拟结果和理论结果大致吻合，实验结果理想。




